<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bbs">

	<!-- apt * by apt_code  --> 
	<select id="aptAll" parameterType="aptVO" resultType="aptVO">
		select * from apt where apt_code = #{apt_code}
	</select>
	
	<!-- member * by member_code  --> 
	<select id="memberAll" parameterType="memberVO" resultType="memberVO">
		select * from member where member_code = #{member_code}
	</select>



	<!-- cate별로 상세 게시판 보기. --> 
	<!-- 세션의 apt_code 와 <a href>의 bbs_cate를 둘 다 일치하는 게시글 목록 들고오기 -->
	<select id="getList5" parameterType="bbsVO" resultType="bbsVO">
		select * from bbs where apt_code=#{apt_code} AND bbs_cate=#{bbs_cate} ORDER BY bbs_date DESC limit 5
	</select>
	
	<!-- cate별로 상세 게시판 보기. --> 
	<!-- 세션의 apt_code 와 <a href>의 bbs_cate를 둘 다 일치하는 게시글 목록 들고오기 -->
	<select id="getListCate" parameterType="bbsVO" resultType="bbsVO">
		select * from bbs where apt_code=#{apt_code} AND bbs_cate=#{bbs_cate}
	</select>
	
	<!-- noti write버튼 admin 필터링 -->
	<!-- id로 cls 확인 -->
	<select id="id2cls" parameterType="memberVO" resultType="memberVO">
        select member_cls from member where member_id=#{member_id}
    </select>
	
	<!-- 게시글 보기 -->
	<!-- <a href>의 bbs_id로 게시글 정보 가져오기 -->
	<select id="getBbsPost" parameterType="bbsVO" resultType="bbsVO">
		select * from bbs where bbs_id=#{bbs_id}
	</select>
	
	<!-- 게시글 삽입 -->
	<insert id="insertPost" parameterType="bbsVO">
		insert into bbs(bbs_title, bbs_date, bbs_writer, bbs_content, bbs_file, apt_code, bbs_notice, bbs_cate) 
					values(#{bbs_title}, NOW(), #{bbs_writer}, #{bbs_content}, #{bbs_file},#{apt_code},#{bbs_notice},#{bbs_cate})
	</insert>
	<!-- 게시글 수정 -->
	<update id="updatePost" parameterType="bbsVO">
		update bbs set bbs_title=#{bbs_title}, bbs_content=#{bbs_content}, bbs_cate=#{bbs_cate}, bbs_notice=#{bbs_notice} where bbs_id=#{bbs_id}
	</update>
	<!-- 게시글 삭제 -->
	<delete id="deletePost" parameterType="bbsVO">
		delete from bbs where bbs_id= #{bbs_id}
	</delete>
	
	<!-- delete, update, all, search, 다시 참조하기--> 
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<!-- 휘동 작업 영역  -->
	<select id="bbshotall" resultType="bbsVO">
		select * from bbs ORDER BY bbs_date DESC limit 5
	</select>
	
	<select id="bbshotone" parameterType="bbsVO" resultType="bbsVO">
		select * from bbs where bbs_id = #{bbs_id}
	</select>
	
	<!-- 조회수 -->
	<update id="bbshotup" parameterType="int">
		update bbs set bbs_count = bbs_count+1 where bbs_id = #{bbs_id}
	</update>
	
	<!-- 좋아요 누르면 올라가기 -->
<!-- 	<update id="memberlike" parameterType="likeVO">
		<![CDATA[
		UPDATE member SET member_like = CONCAT(member_like, #{bbs_id}, ', ' ) WHERE member_id = #{member_id}
		]]>
	</update> -->

	<!-- <select id="bbslikeone" parameterType="bbslikeVO" resultType="boolean">
		select * from bbs_like where bbs_id = #{bbs_id} and member_code = #{member_code}
	</select> -->
	
	<!-- 좋아요 추가 -->
	<insert id="bbslike" parameterType="bbslikeVO">
		insert into bbs_like(bbs_id, member_code, like_time) values (#{bbs_id}, #{member_code}, now())
	</insert>
	<!-- bbs_like 테이블 검색 -->
	<select id="bbslikeone" parameterType="bbslikeVO" resultType="bbslikeVO">
		select * from bbs_like where bbs_id = #{bbs_id}
	</select>
	
	<!-- 좋아요 삭제 -->
	<delete id="bbslikedel" parameterType="bbslikeVO">
		DELETE FROM bbs_like WHERE bbs_id= #{bbs_id} and member_code = #{member_code}
	</delete>
	
	
	
	
	
	
	
	

	
</mapper>